{
  "version": 3,
  "names": [
    "ToolbarItems",
    "props",
    "prefixCls",
    "overflow",
    "useContext",
    "EditorContext",
    "fullscreen",
    "preview",
    "barPopup",
    "components",
    "commandOrchestrator",
    "dispatch",
    "originalOverflow",
    "useRef",
    "handleClick",
    "command",
    "name",
    "state",
    "keyCommand",
    "value",
    "commands",
    "forEach",
    "item",
    "groupName",
    "parent",
    "Object",
    "keys",
    "keyName",
    "length",
    "executeCommand",
    "useEffect",
    "document",
    "body",
    "style",
    "current",
    "window",
    "getComputedStyle",
    "map",
    "idx",
    "liProps",
    "activeBtn",
    "childNode",
    "children",
    "getState",
    "textApi",
    "undefined",
    "close",
    "execute",
    "disabled",
    "test",
    "render",
    "toolbar",
    "com",
    "React",
    "isValidElement",
    "buttonProps",
    "icon",
    "createElement",
    "type",
    "key",
    "onClick",
    "evn",
    "stopPropagation",
    "Array",
    "isArray",
    "Toolbar",
    "toolbarBottom",
    "isChild",
    "extraCommands",
    "bottomClassName"
  ],
  "sources": [
    "../../../src/components/Toolbar/index.tsx"
  ],
  "sourcesContent": [
    "import React, { Fragment, useContext, useEffect, useRef } from 'react';\nimport { IProps } from '../../Editor';\nimport { EditorContext, PreviewType, ContextStore } from '../../Context';\nimport { ICommand } from '../../commands';\nimport Child from './Child';\nimport './index.less';\n\nexport interface IToolbarProps extends IProps {\n  overflow?: boolean;\n  toolbarBottom?: boolean;\n  onCommand?: (command: ICommand<string>, groupName?: string) => void;\n  commands?: ICommand<string>[];\n  isChild?: boolean;\n}\n\nexport function ToolbarItems(props: IToolbarProps) {\n  const { prefixCls, overflow } = props;\n  const { fullscreen, preview, barPopup = {}, components, commandOrchestrator, dispatch } = useContext(EditorContext);\n  const originalOverflow = useRef('');\n\n  function handleClick(command: ICommand<string>, name?: string) {\n    if (!dispatch) return;\n    const state: ContextStore = { barPopup: { ...barPopup } };\n    if (command.keyCommand === 'preview') {\n      state.preview = command.value as PreviewType;\n    }\n    if (command.keyCommand === 'fullscreen') {\n      state.fullscreen = !fullscreen;\n    }\n    if (props.commands && command.keyCommand === 'group') {\n      props.commands.forEach((item) => {\n        if (name === item.groupName) {\n          state.barPopup![name!] = true;\n        } else if (item.keyCommand) {\n          state.barPopup![item.groupName!] = false;\n        }\n      });\n    } else if (name || command.parent) {\n      Object.keys(state.barPopup || {}).forEach((keyName) => {\n        state.barPopup![keyName] = false;\n      });\n    }\n\n    if (Object.keys(state).length) {\n      dispatch({ ...state });\n    }\n    commandOrchestrator && commandOrchestrator.executeCommand(command);\n  }\n\n  useEffect(() => {\n    if (document && overflow) {\n      if (fullscreen) {\n        // prevent scroll on fullscreen\n        document.body.style.overflow = 'hidden';\n      } else {\n        // get the original overflow only the first time\n        if (!originalOverflow.current) {\n          originalOverflow.current = window.getComputedStyle(document.body, null).overflow;\n        }\n        // reset to the original overflow\n        document.body.style.overflow = originalOverflow.current;\n      }\n    }\n  }, [fullscreen, originalOverflow, overflow]);\n\n  return (\n    <ul>\n      {(props.commands || []).map((item, idx) => {\n        if (item.keyCommand === 'divider') {\n          return <li key={idx} {...item.liProps} className={`${prefixCls}-toolbar-divider`} />;\n        }\n        if (!item.keyCommand) return <Fragment key={idx} />;\n        const activeBtn =\n          (fullscreen && item.keyCommand === 'fullscreen') || (item.keyCommand === 'preview' && preview === item.value);\n        const childNode =\n          item.children && typeof item.children === 'function'\n            ? item.children({\n                getState: () => commandOrchestrator!.getState(),\n                textApi: commandOrchestrator ? commandOrchestrator!.textApi : undefined,\n                close: () => handleClick({}, item.groupName),\n                execute: () => handleClick({ execute: item.execute }),\n              })\n            : undefined;\n        const disabled = barPopup && preview && preview === 'preview' && !/(preview|fullscreen)/.test(item.keyCommand);\n        const render = components?.toolbar || item.render;\n        const com = (\n          render && typeof render === 'function' ? render(item, !!disabled, handleClick, idx) : null\n        ) as React.ReactElement;\n        return (\n          <li key={idx} {...item.liProps} className={activeBtn ? `active` : ''}>\n            {com && React.isValidElement(com) && com}\n            {!com && !item.buttonProps && item.icon}\n            {!com &&\n              item.buttonProps &&\n              React.createElement(\n                'button',\n                {\n                  type: 'button',\n                  key: idx,\n                  disabled,\n                  'data-name': item.name,\n                  ...item.buttonProps,\n                  onClick: (evn: React.MouseEvent<HTMLButtonElement, MouseEvent>) => {\n                    evn.stopPropagation();\n                    handleClick(item, item.groupName);\n                  },\n                },\n                item.icon,\n              )}\n            {item.children && (\n              <Child\n                overflow={overflow}\n                groupName={item.groupName}\n                prefixCls={prefixCls}\n                children={childNode}\n                commands={Array.isArray(item.children) ? item.children : undefined}\n              />\n            )}\n          </li>\n        );\n      })}\n    </ul>\n  );\n}\n\nexport default function Toolbar(props: IToolbarProps = {}) {\n  const { prefixCls, toolbarBottom, isChild } = props;\n  const { commands, extraCommands } = useContext(EditorContext);\n  const bottomClassName = toolbarBottom ? 'bottom' : '';\n  return (\n    <div className={`${prefixCls}-toolbar ${bottomClassName}`}>\n      <ToolbarItems {...props} commands={props.commands || commands || []} />\n      {!isChild && <ToolbarItems {...props} commands={extraCommands || []} />}\n    </div>\n  );\n}\n"
  ],
  "mappings": "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"
}