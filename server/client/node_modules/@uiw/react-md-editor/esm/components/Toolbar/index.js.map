{
  "version": 3,
  "names": [
    "React",
    "Fragment",
    "useContext",
    "useEffect",
    "useRef",
    "EditorContext",
    "Child",
    "ToolbarItems",
    "props",
    "prefixCls",
    "overflow",
    "fullscreen",
    "preview",
    "barPopup",
    "components",
    "commandOrchestrator",
    "dispatch",
    "originalOverflow",
    "handleClick",
    "command",
    "name",
    "state",
    "keyCommand",
    "value",
    "commands",
    "forEach",
    "item",
    "groupName",
    "parent",
    "Object",
    "keys",
    "keyName",
    "length",
    "executeCommand",
    "document",
    "body",
    "style",
    "current",
    "window",
    "getComputedStyle",
    "map",
    "idx",
    "liProps",
    "activeBtn",
    "childNode",
    "children",
    "getState",
    "textApi",
    "undefined",
    "close",
    "execute",
    "disabled",
    "test",
    "render",
    "toolbar",
    "com",
    "isValidElement",
    "buttonProps",
    "icon",
    "createElement",
    "type",
    "key",
    "onClick",
    "evn",
    "stopPropagation",
    "Array",
    "isArray",
    "Toolbar",
    "toolbarBottom",
    "isChild",
    "extraCommands",
    "bottomClassName"
  ],
  "sources": [
    "../../../src/components/Toolbar/index.tsx"
  ],
  "sourcesContent": [
    "import React, { Fragment, useContext, useEffect, useRef } from 'react';\nimport { IProps } from '../../Editor';\nimport { EditorContext, PreviewType, ContextStore } from '../../Context';\nimport { ICommand } from '../../commands';\nimport Child from './Child';\nimport './index.less';\n\nexport interface IToolbarProps extends IProps {\n  overflow?: boolean;\n  toolbarBottom?: boolean;\n  onCommand?: (command: ICommand<string>, groupName?: string) => void;\n  commands?: ICommand<string>[];\n  isChild?: boolean;\n}\n\nexport function ToolbarItems(props: IToolbarProps) {\n  const { prefixCls, overflow } = props;\n  const { fullscreen, preview, barPopup = {}, components, commandOrchestrator, dispatch } = useContext(EditorContext);\n  const originalOverflow = useRef('');\n\n  function handleClick(command: ICommand<string>, name?: string) {\n    if (!dispatch) return;\n    const state: ContextStore = { barPopup: { ...barPopup } };\n    if (command.keyCommand === 'preview') {\n      state.preview = command.value as PreviewType;\n    }\n    if (command.keyCommand === 'fullscreen') {\n      state.fullscreen = !fullscreen;\n    }\n    if (props.commands && command.keyCommand === 'group') {\n      props.commands.forEach((item) => {\n        if (name === item.groupName) {\n          state.barPopup![name!] = true;\n        } else if (item.keyCommand) {\n          state.barPopup![item.groupName!] = false;\n        }\n      });\n    } else if (name || command.parent) {\n      Object.keys(state.barPopup || {}).forEach((keyName) => {\n        state.barPopup![keyName] = false;\n      });\n    }\n\n    if (Object.keys(state).length) {\n      dispatch({ ...state });\n    }\n    commandOrchestrator && commandOrchestrator.executeCommand(command);\n  }\n\n  useEffect(() => {\n    if (document && overflow) {\n      if (fullscreen) {\n        // prevent scroll on fullscreen\n        document.body.style.overflow = 'hidden';\n      } else {\n        // get the original overflow only the first time\n        if (!originalOverflow.current) {\n          originalOverflow.current = window.getComputedStyle(document.body, null).overflow;\n        }\n        // reset to the original overflow\n        document.body.style.overflow = originalOverflow.current;\n      }\n    }\n  }, [fullscreen, originalOverflow, overflow]);\n\n  return (\n    <ul>\n      {(props.commands || []).map((item, idx) => {\n        if (item.keyCommand === 'divider') {\n          return <li key={idx} {...item.liProps} className={`${prefixCls}-toolbar-divider`} />;\n        }\n        if (!item.keyCommand) return <Fragment key={idx} />;\n        const activeBtn =\n          (fullscreen && item.keyCommand === 'fullscreen') || (item.keyCommand === 'preview' && preview === item.value);\n        const childNode =\n          item.children && typeof item.children === 'function'\n            ? item.children({\n                getState: () => commandOrchestrator!.getState(),\n                textApi: commandOrchestrator ? commandOrchestrator!.textApi : undefined,\n                close: () => handleClick({}, item.groupName),\n                execute: () => handleClick({ execute: item.execute }),\n              })\n            : undefined;\n        const disabled = barPopup && preview && preview === 'preview' && !/(preview|fullscreen)/.test(item.keyCommand);\n        const render = components?.toolbar || item.render;\n        const com = (\n          render && typeof render === 'function' ? render(item, !!disabled, handleClick, idx) : null\n        ) as React.ReactElement;\n        return (\n          <li key={idx} {...item.liProps} className={activeBtn ? `active` : ''}>\n            {com && React.isValidElement(com) && com}\n            {!com && !item.buttonProps && item.icon}\n            {!com &&\n              item.buttonProps &&\n              React.createElement(\n                'button',\n                {\n                  type: 'button',\n                  key: idx,\n                  disabled,\n                  'data-name': item.name,\n                  ...item.buttonProps,\n                  onClick: (evn: React.MouseEvent<HTMLButtonElement, MouseEvent>) => {\n                    evn.stopPropagation();\n                    handleClick(item, item.groupName);\n                  },\n                },\n                item.icon,\n              )}\n            {item.children && (\n              <Child\n                overflow={overflow}\n                groupName={item.groupName}\n                prefixCls={prefixCls}\n                children={childNode}\n                commands={Array.isArray(item.children) ? item.children : undefined}\n              />\n            )}\n          </li>\n        );\n      })}\n    </ul>\n  );\n}\n\nexport default function Toolbar(props: IToolbarProps = {}) {\n  const { prefixCls, toolbarBottom, isChild } = props;\n  const { commands, extraCommands } = useContext(EditorContext);\n  const bottomClassName = toolbarBottom ? 'bottom' : '';\n  return (\n    <div className={`${prefixCls}-toolbar ${bottomClassName}`}>\n      <ToolbarItems {...props} commands={props.commands || commands || []} />\n      {!isChild && <ToolbarItems {...props} commands={extraCommands || []} />}\n    </div>\n  );\n}\n"
  ],
  "mappings": "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"
}